// База знаний о морских свинках
const guineaPigKnowledge = {
    питание: [
        "Основу рациона составляет сено (должно быть всегда в свободном доступе)",
        "Свежие овощи и зелень (петрушка, морковь, огурцы)",
        "Специальные гранулированные корма",
        "Витамин C необходим ежедневно",
        "Всегда должна быть свежая вода"
    ],
    содержание: [
        "Оптимальная температура 18-24°C",
        "Клетка минимум 60x40 см для одной свинки",
        "Избегать сквозняков",
        "Регулярная уборка клетки",
        "Наполнитель должен быть нетоксичным"
    ],
    здоровье: [
        "Регулярный осмотр у ветеринара",
        "Подстригать когти каждые 4-6 недель",
        "Следить за состоянием зубов",
        "Проверять кожу на наличие паразитов",
        "Вес должен быть стабильным"
    ],
    поведение: [
        "Социальные животные, лучше содержать парами",
        "Любят прятаться в укрытиях",
        "Издают различные звуки для коммуникации",
        "Активны днем и в сумерках",
        "Требуют регулярного общения с хозяином"
    ]
};

class AIHelper {
    constructor() {
        this.knowledge = guineaPigKnowledge;
    }

    // Поиск ключевых слов в вопросе
    findKeywords(question) {
        const keywords = {
            питание: ['еда', 'корм', 'кормление', 'питание', 'сено', 'вода', 'овощи', 'витамины'],
            содержание: ['клетка', 'температура', 'содержание', 'уборка', 'наполнитель', 'условия'],
            здоровье: ['болезнь', 'здоровье', 'ветеринар', 'когти', 'зубы', 'вес'],
            поведение: ['поведение', 'характер', 'привычки', 'звуки', 'общение']
        };

        const questionLower = question.toLowerCase();
        let matchedCategories = [];

        for (const [category, words] of Object.entries(keywords)) {
            if (words.some(word => questionLower.includes(word))) {
                matchedCategories.push(category);
            }
        }

        return matchedCategories;
    }

    // Генерация ответа на основе базы знаний
    generateResponse(question) {
        const categories = this.findKeywords(question);
        
        if (categories.length === 0) {
            return `Извините, я не совсем понял ваш вопрос. Попробуйте спросить о питании, содержании, здоровье или поведении морских свинок.`;
        }

        let response = `Вот что я знаю по вашему вопросу:\n\n`;
        
        categories.forEach(category => {
            response += `По теме "${category}":\n`;
            this.knowledge[category].forEach(fact => {
                response += `• ${fact}\n`;
            });
            response += '\n';
        });

        return response;
    }

    // Обработка вопроса пользователя
    async processQuestion(question) {
        try {
            // Здесь можно добавить вызов реального AI API
            // Пока используем локальную базу знаний
            return this.generateResponse(question);
        } catch (error) {
            console.error('Ошибка при обработке вопроса:', error);
            return 'Извините, произошла ошибка при обработке вашего вопроса. Попробуйте переформулировать его.';
        }
    }
}

// Экспорт класса для использования в основном файле
window.AIHelper = AIHelper; 